{"ast":null,"code":"import _extends from '@babel/runtime/helpers/esm/extends';\nimport React, { forwardRef, useRef, useEffect, useLayoutEffect, useState, useMemo, Children, createElement } from 'react';\nimport { extend, useThree, useFrame, useUpdate, useLoader, addEffect, addAfterEffect, applyProps } from 'react-three-fiber';\nimport { OrbitControls as OrbitControls$1, MapControls as MapControls$1 } from 'three/examples/jsm/controls/OrbitControls';\nimport mergeRefs from 'react-merge-refs';\nimport { TrackballControls as TrackballControls$1 } from 'three/examples/jsm/controls/TrackballControls';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport { TransformControls as TransformControls$1 } from 'three/examples/jsm/controls/TransformControls';\nimport pick from 'lodash.pick';\nimport omit from 'lodash.omit';\nimport { AudioListener, AudioLoader, HalfFloatType, Vector3, PerspectiveCamera as PerspectiveCamera$1, OrthographicCamera as OrthographicCamera$1, Color, MeshStandardMaterial, Vector2, Spherical, AdditiveBlending, ShaderMaterial, ShaderChunk, Matrix4, Ray, Sphere as Sphere$1, Raycaster, Camera } from 'three';\nimport { SMAAImageLoader, EffectComposer, RenderPass, SMAAEffect, NormalPass, SSAOEffect, BlendFunction, BloomEffect, KernelSize, EffectPass } from 'postprocessing';\nimport { Text as Text$1 } from 'troika-three-text';\nimport ReactDOM from 'react-dom';\nimport StatsImpl from 'stats.js';\nimport { Sky as Sky$1 } from 'three/examples/jsm/objects/Sky';\nimport { LineGeometry } from 'three/examples/jsm/lines/LineGeometry';\nimport { LineMaterial } from 'three/examples/jsm/lines/LineMaterial';\nimport { Line2 } from 'three/examples/jsm/lines/Line2';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader';\nextend({\n  OrbitControlsImpl: OrbitControls$1\n});\nconst OrbitControls = /*#__PURE__*/forwardRef((props = {\n  enableDamping: true\n}, ref) => {\n  const controls = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useFrame(() => {\n    var _controls$current;\n\n    return (_controls$current = controls.current) == null ? void 0 : _controls$current.update();\n  });\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(\"orbitControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement],\n    enableDamping: true\n  }, props));\n});\nextend({\n  MapControlsImpl: MapControls$1\n});\nconst MapControls = /*#__PURE__*/forwardRef((props = {\n  enableDamping: true\n}, ref) => {\n  const controls = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useFrame(() => {\n    var _controls$current;\n\n    return (_controls$current = controls.current) == null ? void 0 : _controls$current.update();\n  });\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(\"mapControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement],\n    enableDamping: true\n  }, props));\n});\nextend({\n  TrackballControlsImpl: TrackballControls$1\n});\nconst TrackballControls = /*#__PURE__*/forwardRef((props, ref) => {\n  const controls = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useFrame(() => {\n    var _controls$current;\n\n    return (_controls$current = controls.current) == null ? void 0 : _controls$current.update();\n  });\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(\"trackballControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement]\n  }, props));\n});\nextend({\n  TransformControlsImpl: TransformControls$1\n});\nconst TransformControls = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\"]);\n\n  const transformOnlyPropNames = ['enabled', 'axis', 'mode', 'translationSnap', 'rotationSnap', 'scaleSnap', 'space', 'size', 'dragging', 'showX', 'showY', 'showZ'];\n  const transformProps = pick(props, transformOnlyPropNames);\n  const objectProps = omit(props, transformOnlyPropNames);\n  const controls = useRef();\n  const group = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useLayoutEffect(() => {\n    var _controls$current;\n\n    return void ((_controls$current = controls.current) == null ? void 0 : _controls$current.attach(group.current));\n  }, [children]);\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"transformControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement]\n  }, transformProps)), /*#__PURE__*/React.createElement(\"group\", _extends({\n    ref: group\n  }, objectProps), children));\n});\nconst Detailed = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    distances\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"distances\"]);\n\n  const lod = useUpdate(lod => {\n    lod.levels.length = 0;\n    lod.children.forEach((object, index) => lod.levels.push({\n      object,\n      distance: distances[index]\n    }));\n  }, []);\n  useFrame(state => {\n    var _lod$current;\n\n    return (_lod$current = lod.current) == null ? void 0 : _lod$current.update(state.camera);\n  });\n  return /*#__PURE__*/React.createElement(\"lOD\", _extends({\n    ref: mergeRefs([lod, ref])\n  }, props), children);\n});\nconst PositionalAudio = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    url,\n    distance = 1,\n    loop = true\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"url\", \"distance\", \"loop\"]);\n\n  const sound = useRef();\n  const {\n    camera\n  } = useThree();\n  const [listener] = useState(() => new AudioListener());\n  const buffer = useLoader(AudioLoader, url);\n  useEffect(() => {\n    var _sound$current, _sound$current2, _sound$current3, _sound$current4;\n\n    (_sound$current = sound.current) == null ? void 0 : _sound$current.setBuffer(buffer);\n    (_sound$current2 = sound.current) == null ? void 0 : _sound$current2.setRefDistance(distance);\n    (_sound$current3 = sound.current) == null ? void 0 : _sound$current3.setLoop(loop);\n    (_sound$current4 = sound.current) == null ? void 0 : _sound$current4.play();\n    camera.add(listener);\n    return () => void camera.remove(listener);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"positionalAudio\", _extends({\n    ref: mergeRefs([sound, ref]),\n    args: [listener]\n  }, props));\n});\nconst PerspectiveCamera = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    makeDefault = false\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"makeDefault\"]);\n\n  const {\n    setDefaultCamera,\n    camera,\n    size\n  } = useThree();\n  const cameraRef = useUpdate(cam => {\n    cam.aspect = size.width / size.height;\n    cam.updateProjectionMatrix();\n  }, [size, props]);\n  useLayoutEffect(() => {\n    if (makeDefault && cameraRef.current) {\n      const oldCam = camera;\n      setDefaultCamera(cameraRef.current);\n      return () => setDefaultCamera(oldCam);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(\"perspectiveCamera\", _extends({\n    ref: mergeRefs([cameraRef, ref])\n  }, props), children);\n});\nconst OrthographicCamera = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    makeDefault = false\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"makeDefault\"]);\n\n  const {\n    setDefaultCamera,\n    camera,\n    size\n  } = useThree();\n  const cameraRef = useUpdate(cam => cam.updateProjectionMatrix(), [size, props]);\n  useLayoutEffect(() => {\n    if (makeDefault && cameraRef.current) {\n      const oldCam = camera;\n      setDefaultCamera(cameraRef.current);\n      return () => setDefaultCamera(oldCam);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(\"orthographicCamera\", _extends({\n    left: size.width / -2,\n    right: size.width / 2,\n    top: size.height / 2,\n    bottom: size.height / -2,\n    ref: mergeRefs([cameraRef, ref])\n  }, props), children);\n});\n\nfunction StandardEffects({\n  smaa = true,\n  ao = true,\n  bloom = true,\n  edgeDetection = 0.1,\n  bloomOpacity = 1,\n  effects\n}) {\n  const {\n    gl,\n    scene,\n    camera,\n    size\n  } = useThree();\n  const smaaProps = useLoader(SMAAImageLoader, '');\n  const composer = useMemo(() => {\n    const composer = new EffectComposer(gl, {\n      frameBufferType: HalfFloatType\n    });\n    composer.addPass(new RenderPass(scene, camera));\n    const smaaEffect = new SMAAEffect(...smaaProps);\n    smaaEffect.colorEdgesMaterial.setEdgeDetectionThreshold(edgeDetection);\n    const normalPass = new NormalPass(scene, camera);\n    const ssaoEffect = new SSAOEffect(camera, normalPass.renderTarget.texture, _extends({\n      blendFunction: BlendFunction.MULTIPLY,\n      samples: 21,\n      // May get away with less samples\n      rings: 4,\n      // Just make sure this isn't a multiple of samples\n      distanceThreshold: 1.0,\n      distanceFalloff: 0.0,\n      rangeThreshold: 0.015,\n      // Controls sensitivity based on camera view distance **\n      rangeFalloff: 0.002,\n      luminanceInfluence: 0.9,\n      radius: 20,\n      // Spread range\n      scale: 1.0,\n      // Controls intensity **\n      bias: 0.05\n    }, ao));\n    const bloomEffect = new BloomEffect(_extends({\n      opacity: 1,\n      blendFunction: BlendFunction.SCREEN,\n      kernelSize: KernelSize.VERY_LARGE,\n      luminanceThreshold: 0.9,\n      luminanceSmoothing: 0.07,\n      height: 600\n    }, bloom));\n    bloomEffect.blendMode.opacity.value = bloomOpacity;\n    let effectsArray = [];\n    if (effects) effectsArray = effects([smaaEffect, ssaoEffect, bloomEffect]);else {\n      if (smaa) effectsArray.push(smaaEffect);\n      if (ao) effectsArray.push(ssaoEffect);\n      if (bloom) effectsArray.push(bloomEffect);\n    }\n    const effectPass = new EffectPass(camera, ...effectsArray);\n    effectPass.renderToScreen = true;\n    composer.addPass(normalPass);\n    composer.addPass(effectPass);\n    return composer;\n  }, [camera, gl, scene, smaa, ao, bloom, edgeDetection, bloomOpacity]);\n  useEffect(() => void composer.setSize(size.width, size.height), [composer, size]);\n  return useFrame((_, delta) => composer.render(delta), 1);\n}\n\nextend({\n  TextMeshImpl: Text$1\n});\nconst Text = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    anchorX = 'center',\n    anchorY = 'middle',\n    children\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"anchorX\", \"anchorY\", \"children\"]);\n\n  const textRef = useRef();\n  const [baseMtl, setBaseMtl] = useState();\n  const [nodes, text] = useMemo(() => {\n    let n = [];\n    let t = '';\n    Children.forEach(children, child => {\n      if (typeof child === 'string') t += child;else if (child && typeof child === 'object' && child.props.attach === 'material') {\n        // Instantiate the base material and grab a reference to it, but don't assign any\n        // props, and assign it as the `material`, which Troika will replace behind the scenes.\n        n.push( /*#__PURE__*/createElement(child.type, {\n          ref: setBaseMtl,\n          attach: 'material'\n        })); // Once the base material has been assigned, grab the resulting upgraded material,\n        // and apply the original material props to that.\n\n        if (baseMtl) {\n          n.push( /*#__PURE__*/React.createElement(\"primitive\", _extends({\n            object: textRef.current.material\n          }, child.props, {\n            attach: null\n          })));\n        }\n      } else n.push(child);\n    });\n    return [n, t];\n  }, [children, baseMtl]);\n  useLayoutEffect(() => void textRef.current.sync());\n  return /*#__PURE__*/React.createElement(\"textMeshImpl\", _extends({\n    ref: mergeRefs([textRef, ref]),\n    text: text,\n    anchorX: anchorX,\n    anchorY: anchorY\n  }, props), nodes);\n});\nconst v1 = new Vector3();\nconst v2 = new Vector3();\nconst v3 = new Vector3();\n\nfunction calculatePosition(el, camera, size) {\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n  objectPos.project(camera);\n  const widthHalf = size.width / 2;\n  const heightHalf = size.height / 2;\n  return [objectPos.x * widthHalf + widthHalf, -(objectPos.y * heightHalf) + heightHalf];\n}\n\nfunction isObjectBehindCamera(el, camera) {\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n  const deltaCamObj = objectPos.sub(cameraPos);\n  const camDir = camera.getWorldDirection(v3);\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\n}\n\nfunction objectScale(el, camera) {\n  if (camera instanceof PerspectiveCamera$1) {\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n    const vFOV = camera.fov * Math.PI / 180;\n    const dist = objectPos.distanceTo(cameraPos);\n    return 1 / (2 * Math.tan(vFOV / 2) * dist);\n  }\n\n  if (camera instanceof OrthographicCamera$1) return camera.zoom;\n  return 1;\n}\n\nfunction objectZIndex(el, camera, zIndexRange) {\n  if (camera instanceof PerspectiveCamera$1 || camera instanceof OrthographicCamera$1) {\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n    const dist = objectPos.distanceTo(cameraPos);\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\n    const B = zIndexRange[1] - A * camera.far;\n    return Math.round(A * dist + B);\n  }\n\n  return undefined;\n}\n\nconst Html = /*#__PURE__*/React.forwardRef((_ref, ref) => {\n  var _portal$current;\n\n  let {\n    children,\n    eps = 0.001,\n    style,\n    className,\n    prepend,\n    center,\n    fullscreen,\n    portal,\n    scaleFactor,\n    zIndexRange = [16777271, 0]\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"eps\", \"style\", \"className\", \"prepend\", \"center\", \"fullscreen\", \"portal\", \"scaleFactor\", \"zIndexRange\"]);\n\n  const {\n    gl,\n    scene,\n    camera,\n    size\n  } = useThree();\n  const [el] = useState(() => document.createElement('div'));\n  const group = useRef(null);\n  const old = useRef([0, 0]);\n  const target = (_portal$current = portal == null ? void 0 : portal.current) != null ? _portal$current : gl.domElement.parentNode;\n  useEffect(() => {\n    if (group.current) {\n      scene.updateMatrixWorld();\n      const vec = calculatePosition(group.current, camera, size);\n      el.style.cssText = \"position:absolute;top:0;left:0;transform:translate3d(\" + vec[0] + \"px,\" + vec[1] + \"px,0);transform-origin:0 0;\";\n\n      if (target) {\n        if (prepend) target.prepend(el);else target.appendChild(el);\n      }\n\n      return () => {\n        if (target) target.removeChild(el);\n        ReactDOM.unmountComponentAtNode(el);\n      };\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [target]);\n  const styles = useMemo(() => _extends({\n    position: 'absolute',\n    transform: center ? 'translate3d(-50%,-50%,0)' : 'none'\n  }, fullscreen && {\n    top: -size.height / 2,\n    left: -size.width / 2,\n    width: size.width,\n    height: size.height\n  }, style), [style, center, fullscreen, size]);\n  useEffect(() => void ReactDOM.render( /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    style: styles,\n    className: className,\n    children: children\n  }), el));\n  useFrame(() => {\n    if (group.current) {\n      const vec = calculatePosition(group.current, camera, size);\n\n      if (Math.abs(old.current[0] - vec[0]) > eps || Math.abs(old.current[1] - vec[1]) > eps) {\n        el.style.display = !isObjectBehindCamera(group.current, camera) ? 'block' : 'none';\n        const scale = scaleFactor === undefined ? 1 : objectScale(group.current, camera) * scaleFactor;\n        el.style.transform = \"translate3d(\" + vec[0] + \"px,\" + vec[1] + \"px,0) scale(\" + scale + \")\";\n        el.style.zIndex = \"\" + objectZIndex(group.current, camera, zIndexRange);\n      }\n\n      old.current = vec;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: group\n  }));\n});\nconst HTML = /*#__PURE__*/React.forwardRef((props, ref) => {\n  useEffect(() => void console.warn('The <HTML> component was renamed to <Html>'), []);\n  return /*#__PURE__*/React.createElement(Html, _extends({}, props, {\n    ref: ref\n  }));\n});\nconst Shadow = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    fog = false,\n    colorStop = 0.0,\n    color = 'black',\n    opacity = 0.5\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"fog\", \"colorStop\", \"color\", \"opacity\"]);\n\n  const canvas = useMemo(() => {\n    let canvas = document.createElement('canvas');\n    canvas.width = 128;\n    canvas.height = 128;\n    let context = canvas.getContext('2d');\n    let gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width / 2);\n    gradient.addColorStop(colorStop, new Color(color).getStyle());\n    gradient.addColorStop(1, 'rgba(0,0,0,0)');\n    context.fillStyle = gradient;\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    return canvas;\n  }, [color, stop]);\n  return /*#__PURE__*/React.createElement(\"mesh\", _extends({\n    ref: ref\n  }, props), /*#__PURE__*/React.createElement(\"planeBufferGeometry\", {\n    attach: \"geometry\",\n    args: [1, 1]\n  }), /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    attach: \"material\",\n    transparent: true,\n    opacity: opacity,\n    fog: fog\n  }, /*#__PURE__*/React.createElement(\"canvasTexture\", {\n    attach: \"map\",\n    args: [canvas]\n  })));\n});\n\nfunction Stats({\n  showPanel = 0,\n  className,\n  parent\n}) {\n  const [stats] = useState(() => new StatsImpl());\n  useEffect(() => {\n    const node = parent && parent.current || document.body;\n    stats.showPanel(showPanel);\n    node == null ? void 0 : node.appendChild(stats.dom);\n    if (className) stats.dom.classList.add(className);\n    const begin = addEffect(() => stats.begin());\n    const end = addAfterEffect(() => stats.end());\n    return () => {\n      node == null ? void 0 : node.removeChild(stats.dom);\n      begin();\n      end();\n    };\n  }, [parent]);\n  return null;\n}\n\nfunction WobbleMaterialImpl(parameters) {\n  MeshStandardMaterial.call(this);\n  this.setValues(parameters);\n  this._time = {\n    value: 0\n  };\n  this._factor = {\n    value: 1\n  };\n\n  this.onBeforeCompile = shader => {\n    shader.uniforms.time = this._time;\n    shader.uniforms.factor = this._factor;\n    shader.vertexShader = 'uniform float time; uniform float factor;\\n' + shader.vertexShader;\n    shader.vertexShader = shader.vertexShader.replace('#include <begin_vertex>', \"float theta = sin( time + position.y ) / 2.0 * factor;\\n        float c = cos( theta );\\n        float s = sin( theta );\\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\\n        vec3 transformed = vec3( position ) * m;\\n        vNormal = vNormal * m;\");\n  };\n\n  Object.defineProperty(this, 'time', {\n    get: () => this._time,\n    set: val => this._time.value = val\n  });\n  Object.defineProperty(this, 'factor', {\n    get: () => this._factor,\n    set: val => this._factor.value = val\n  });\n}\n\nWobbleMaterialImpl.prototype = Object.create(MeshStandardMaterial.prototype);\nWobbleMaterialImpl.prototype.constructor = MeshStandardMaterial;\nWobbleMaterialImpl.prototype.isMeshStandardMaterial = true;\nextend({\n  WobbleMaterialImpl\n});\nconst MeshWobbleMaterial = /*#__PURE__*/React.forwardRef((_ref, ref) => {\n  let {\n    speed = 1\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"speed\"]);\n\n  const material = useRef();\n  useFrame(state => material.current && (material.current.time = state.clock.getElapsedTime() * speed));\n  return /*#__PURE__*/React.createElement(\"wobbleMaterialImpl\", _extends({\n    ref: mergeRefs([ref, material]),\n    attach: \"material\"\n  }, props));\n});\nextend({\n  SkyImpl: Sky$1\n});\nconst Sky = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    distance = 450000,\n    sunPosition = [0, 1, 0]\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"distance\", \"sunPosition\"]);\n\n  const scale = useMemo(() => new Vector3().setScalar(distance), [distance]);\n  return /*#__PURE__*/React.createElement(\"skyImpl\", _extends({\n    ref: ref,\n    \"material-uniforms-sunPosition-value\": sunPosition,\n    scale: scale\n  }, props));\n});\nextend({\n  Line2,\n  LineGeometry,\n  LineMaterial\n});\nconst Line = /*#__PURE__*/React.forwardRef(function Line(_ref, ref) {\n  let {\n    points,\n    color = 'black',\n    vertexColors\n  } = _ref,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"points\", \"color\", \"vertexColors\"]);\n\n  const lineRef = useRef();\n  const geomRef = useRef();\n  const resolution = useMemo(() => new Vector2(512, 512), []);\n  useEffect(() => {\n    if (!geomRef.current || !lineRef.current) return;\n    geomRef.current.setPositions(points.flat());\n    if (vertexColors) geomRef.current.setColors(vertexColors.flat());\n    lineRef.current.computeLineDistances();\n  }, [points, vertexColors]);\n  return /*#__PURE__*/React.createElement(\"line2\", _extends({\n    ref: mergeRefs([lineRef, ref])\n  }, rest), /*#__PURE__*/React.createElement(\"lineGeometry\", {\n    attach: \"geometry\",\n    ref: geomRef\n  }), /*#__PURE__*/React.createElement(\"lineMaterial\", _extends({\n    attach: \"material\",\n    color: color,\n    vertexColors: Boolean(vertexColors),\n    resolution: resolution\n  }, rest)));\n});\n\nclass StarfieldMaterial extends ShaderMaterial {\n  constructor() {\n    super({\n      uniforms: {\n        time: {\n          value: 0.0\n        },\n        fade: {\n          value: 1.0\n        }\n      },\n      vertexShader: \"uniform float time;\\n      attribute float size;\\n      varying vec3 vColor;\\n      void main() {\\n        vColor = color;\\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(mvPosition.x + 2.0 * time + 100.0));\\n        gl_Position = projectionMatrix * mvPosition;\\n      }\",\n      fragmentShader: \"uniform sampler2D pointTexture;\\n      uniform float fade;\\n      varying vec3 vColor;\\n      void main() {\\n        float opacity = 1.0;\\n        if (fade == 1.0) {\\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\\n        }\\n        gl_FragColor = vec4(vColor, opacity);\\n      }\"\n    });\n  }\n\n}\n\nextend({\n  StarfieldMaterial\n});\n\nconst genStar = r => {\n  return new Vector3().setFromSpherical(new Spherical(r, Math.acos(1 - Math.random() * 2), Math.random() * 2 * Math.PI));\n};\n\nconst Stars = /*#__PURE__*/forwardRef(({\n  radius = 100,\n  depth = 50,\n  count = 5000,\n  saturation = 0,\n  factor = 4,\n  fade = false\n}, ref) => {\n  const material = useRef();\n  const [position, color, size] = useMemo(() => {\n    const positions = [];\n    const colors = [];\n    const sizes = Array.from({\n      length: count\n    }, () => (0.5 + 0.5 * Math.random()) * factor);\n    const color = new Color();\n    let r = radius + depth;\n    const increment = depth / count;\n\n    for (var i = 0; i < count; i++) {\n      r -= increment * Math.random();\n      positions.push(...genStar(r).toArray());\n      color.setHSL(i / count, saturation, 0.9);\n      colors.push(color.r, color.g, color.b);\n    }\n\n    return [new Float32Array(positions), new Float32Array(colors), new Float32Array(sizes)];\n  }, []);\n  useFrame(state => material.current && (material.current.uniforms.time.value = state.clock.getElapsedTime()));\n  return /*#__PURE__*/React.createElement(\"points\", {\n    ref: ref\n  }, /*#__PURE__*/React.createElement(\"bufferGeometry\", {\n    attach: \"geometry\"\n  }, /*#__PURE__*/React.createElement(\"bufferAttribute\", {\n    attachObject: ['attributes', 'position'],\n    args: [position, 3]\n  }), /*#__PURE__*/React.createElement(\"bufferAttribute\", {\n    attachObject: ['attributes', 'color'],\n    args: [color, 3]\n  }), /*#__PURE__*/React.createElement(\"bufferAttribute\", {\n    attachObject: ['attributes', 'size'],\n    args: [size, 1]\n  })), /*#__PURE__*/React.createElement(\"starfieldMaterial\", {\n    ref: material,\n    attach: \"material\",\n    blending: AdditiveBlending,\n    \"uniforms-fade-value\": fade,\n    transparent: true,\n    vertexColors: true\n  }));\n});\n\nfunction draco(url = '/draco-gltf/') {\n  return loader => {\n    const dracoLoader = new DRACOLoader();\n    dracoLoader.setDecoderPath(url);\n    loader.setDRACOLoader(dracoLoader);\n  };\n}\n\nconst pcss = ({\n  frustrum = 3.75,\n  size = 0.005,\n  near = 9.5,\n  samples = 17,\n  rings = 11\n} = {}) => \"#define LIGHT_WORLD_SIZE \" + size + \"\\n#define LIGHT_FRUSTUM_WIDTH \" + frustrum + \"\\n#define LIGHT_SIZE_UV (LIGHT_WORLD_SIZE / LIGHT_FRUSTUM_WIDTH)\\n#define NEAR_PLANE \" + near + \"\\n\\n#define NUM_SAMPLES \" + samples + \"\\n#define NUM_RINGS \" + rings + \"\\n#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES\\n#define PCF_NUM_SAMPLES NUM_SAMPLES\\n\\nvec2 poissonDisk[NUM_SAMPLES];\\n\\nvoid initPoissonSamples(const in vec2 randomSeed) {\\n\\tfloat ANGLE_STEP = PI2 * float(NUM_RINGS) / float(NUM_SAMPLES);\\n\\tfloat INV_NUM_SAMPLES = 1.0 / float(NUM_SAMPLES);\\n\\tfloat angle = rand(randomSeed) * PI2;\\n\\tfloat radius = INV_NUM_SAMPLES;\\n\\tfloat radiusStep = radius;\\n\\tfor (int i = 0; i < NUM_SAMPLES; i++) {\\n\\t\\tpoissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\\n\\t\\tradius += radiusStep;\\n\\t\\tangle += ANGLE_STEP;\\n\\t}\\n}\\n\\nfloat penumbraSize(const in float zReceiver, const in float zBlocker) { // Parallel plane estimation\\n\\treturn (zReceiver - zBlocker) / zBlocker;\\n}\\n\\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver) {\\n\\tfloat searchRadius = LIGHT_SIZE_UV * (zReceiver - NEAR_PLANE) / zReceiver;\\n\\tfloat blockerDepthSum = 0.0;\\n\\tint numBlockers = 0;\\n\\tfor (int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++) {\\n\\t\\tfloat shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\\n\\t\\tif (shadowMapDepth < zReceiver) {\\n\\t\\t\\tblockerDepthSum += shadowMapDepth;\\n\\t\\t\\tnumBlockers++;\\n\\t\\t}\\n\\t}\\n\\tif (numBlockers == 0) return -1.0;\\n\\treturn blockerDepthSum / float(numBlockers);\\n}\\n\\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\\n\\tfloat sum = 0.0;\\n\\tfor (int i = 0; i < PCF_NUM_SAMPLES; i++) {\\n\\t\\tfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[ i ] * filterRadius));\\n\\t\\tif (zReceiver <= depth) sum += 1.0;\\n\\t}\\n\\tfor (int i = 0; i < PCF_NUM_SAMPLES; i++) {\\n\\t\\tfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[ i ].yx * filterRadius));\\n\\t\\tif (zReceiver <= depth) sum += 1.0;\\n\\t}\\n\\treturn sum / (2.0 * float(PCF_NUM_SAMPLES));\\n}\\n\\nfloat PCSS(sampler2D shadowMap, vec4 coords) {\\n\\tvec2 uv = coords.xy;\\n\\tfloat zReceiver = coords.z; // Assumed to be eye-space z in this code\\n\\tinitPoissonSamples(uv);\\n\\tfloat avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\\n\\tif (avgBlockerDepth == -1.0) return 1.0;\\n\\tfloat penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\\n\\tfloat filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;\\n\\treturn PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\\n}\";\n\nconst softShadows = props => {\n  let shader = ShaderChunk.shadowmap_pars_fragment;\n  shader = shader.replace('#ifdef USE_SHADOWMAP', '#ifdef USE_SHADOWMAP\\n' + pcss(_extends({}, props)));\n  shader = shader.replace('#if defined( SHADOWMAP_TYPE_PCF )', '\\nreturn PCSS(shadowMap, shadowCoord);\\n#if defined( SHADOWMAP_TYPE_PCF )');\n  ShaderChunk.shadowmap_pars_fragment = shader;\n};\n\nlet _inverseMatrix = new Matrix4();\n\nlet _ray = new Ray();\n\nlet _sphere = new Sphere$1();\n\nlet _vA = new Vector3();\n\nfunction meshBounds(raycaster, intersects) {\n  let geometry = this.geometry;\n  let material = this.material;\n  let matrixWorld = this.matrixWorld;\n  if (material === undefined) return; // Checking boundingSphere distance to ray\n\n  if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\n\n  _sphere.copy(geometry.boundingSphere);\n\n  _sphere.applyMatrix4(matrixWorld);\n\n  if (raycaster.ray.intersectsSphere(_sphere) === false) return;\n\n  _inverseMatrix.getInverse(matrixWorld);\n\n  _ray.copy(raycaster.ray).applyMatrix4(_inverseMatrix); // Check boundingBox before continuing\n\n\n  if (geometry.boundingBox !== null && _ray.intersectBox(geometry.boundingBox, _vA) === null) return;\n  intersects.push({\n    distance: _vA.distanceTo(raycaster.ray.origin),\n    point: _vA.clone(),\n    object: this\n  });\n}\n\nfunction useCamera(camera, props) {\n  const {\n    mouse\n  } = useThree();\n  const [raycast] = useState(() => {\n    let raycaster = new Raycaster();\n    if (props) applyProps(raycaster, props, {});\n    return function (_, intersects) {\n      raycaster.setFromCamera(mouse, camera instanceof Camera ? camera : camera.current);\n      const rc = this.constructor.prototype.raycast.bind(this);\n      if (rc) rc(raycaster, intersects);\n    };\n  });\n  return raycast;\n}\n\nfunction useHelper(object3D, proto, ...args) {\n  const helper = React.useRef();\n  const {\n    scene\n  } = useThree();\n  useEffect(() => {\n    if (proto && object3D.current) {\n      helper.current = new proto(object3D.current, ...args);\n\n      if (helper.current) {\n        scene.add(helper.current);\n      }\n    }\n\n    return () => {\n      if (helper.current) {\n        scene.remove(helper.current);\n      }\n    };\n  }, [scene, proto, object3D, args]);\n  useFrame(() => {\n    if (helper.current) {\n      helper.current.update();\n    }\n  });\n  return helper;\n}\n\nfunction useAspect(type, width, height, factor = 1) {\n  const {\n    viewport: v,\n    aspect\n  } = useThree();\n  const adaptedHeight = height * (aspect > width / height ? v.width / width : v.height / height);\n  const adaptedWidth = width * (aspect > width / height ? v.width / width : v.height / height);\n  return [adaptedWidth * factor, adaptedHeight * factor, 1];\n}\n\nfunction create(type) {\n  const El = type + 'BufferGeometry';\n  return /*#__PURE__*/forwardRef((_ref, ref) => {\n    let {\n      args,\n      children\n    } = _ref,\n        props = _objectWithoutPropertiesLoose(_ref, [\"args\", \"children\"]);\n\n    return /*#__PURE__*/React.createElement(\"mesh\", _extends({\n      ref: ref\n    }, props), /*#__PURE__*/React.createElement(El, {\n      attach: \"geometry\",\n      args: args\n    }), children);\n  });\n}\n\nconst Box = create('box');\nconst Circle = create('circle');\nconst Cone = create('cone');\nconst Cylinder = create('cylinder');\nconst Sphere = create('sphere');\nconst Plane = create('plane');\nconst Tube = create('tube');\nconst Torus = create('torus');\nconst TorusKnot = create('torusKnot');\nconst Tetrahedron = create('tetrahedron');\nconst Ring = create('ring');\nconst Polyhedron = create('polyhedron');\nconst Icosahedron = create('icosahedron');\nconst Octahedron = create('octahedron');\nconst Dodecahedron = create('dodecahedron');\nconst Extrude = create('extrude');\nconst Lathe = create('lathe');\nconst Parametric = create('parametric');\nexport { Box, Circle, Cone, Cylinder, Detailed, Dodecahedron, Extrude, HTML, Html, Icosahedron, Lathe, Line, MapControls, MeshWobbleMaterial, Octahedron, OrbitControls, OrthographicCamera, Parametric, PerspectiveCamera, Plane, Polyhedron, PositionalAudio, Ring, Shadow, Sky, Sphere, StandardEffects, Stars, Stats, Tetrahedron, Text, Torus, TorusKnot, TrackballControls, TransformControls, Tube, draco, meshBounds, softShadows, useAspect, useCamera, useHelper };","map":{"version":3,"sources":["/Users/paris/Desktop/React-3D-Haapi/node_modules/drei/dist/index.js"],"names":["_extends","React","forwardRef","useRef","useEffect","useLayoutEffect","useState","useMemo","Children","createElement","extend","useThree","useFrame","useUpdate","useLoader","addEffect","addAfterEffect","applyProps","OrbitControls","OrbitControls$1","MapControls","MapControls$1","mergeRefs","TrackballControls","TrackballControls$1","_objectWithoutPropertiesLoose","TransformControls","TransformControls$1","pick","omit","AudioListener","AudioLoader","HalfFloatType","Vector3","PerspectiveCamera","PerspectiveCamera$1","OrthographicCamera","OrthographicCamera$1","Color","MeshStandardMaterial","Vector2","Spherical","AdditiveBlending","ShaderMaterial","ShaderChunk","Matrix4","Ray","Sphere","Sphere$1","Raycaster","Camera","SMAAImageLoader","EffectComposer","RenderPass","SMAAEffect","NormalPass","SSAOEffect","BlendFunction","BloomEffect","KernelSize","EffectPass","Text","Text$1","ReactDOM","StatsImpl","Sky","Sky$1","LineGeometry","LineMaterial","Line2","DRACOLoader","OrbitControlsImpl","props","enableDamping","ref","controls","camera","gl","invalidate","_controls$current","current","update","_controls$current2","addEventListener","_controls$current3","removeEventListener","args","domElement","MapControlsImpl","TrackballControlsImpl","TransformControlsImpl","_ref","children","transformOnlyPropNames","transformProps","objectProps","group","attach","Fragment","Detailed","distances","lod","levels","length","forEach","object","index","push","distance","state","_lod$current","PositionalAudio","url","loop","sound","listener","buffer","_sound$current","_sound$current2","_sound$current3","_sound$current4","setBuffer","setRefDistance","setLoop","play","add","remove","makeDefault","setDefaultCamera","size","cameraRef","cam","aspect","width","height","updateProjectionMatrix","oldCam","left","right","top","bottom","StandardEffects","smaa","ao","bloom","edgeDetection","bloomOpacity","effects","scene","smaaProps","composer","frameBufferType","addPass","smaaEffect","colorEdgesMaterial","setEdgeDetectionThreshold","normalPass","ssaoEffect","renderTarget","texture","blendFunction","MULTIPLY","samples","rings","distanceThreshold","distanceFalloff","rangeThreshold","rangeFalloff","luminanceInfluence","radius","scale","bias","bloomEffect","opacity","SCREEN","kernelSize","VERY_LARGE","luminanceThreshold","luminanceSmoothing","blendMode","value","effectsArray","effectPass","renderToScreen","setSize","_","delta","render","TextMeshImpl","anchorX","anchorY","textRef","baseMtl","setBaseMtl","nodes","text","n","t","child","type","material","sync","v1","v2","v3","calculatePosition","el","objectPos","setFromMatrixPosition","matrixWorld","project","widthHalf","heightHalf","x","y","isObjectBehindCamera","cameraPos","deltaCamObj","sub","camDir","getWorldDirection","angleTo","Math","PI","objectScale","vFOV","fov","dist","distanceTo","tan","zoom","objectZIndex","zIndexRange","A","far","near","B","round","undefined","Html","_portal$current","eps","style","className","prepend","center","fullscreen","portal","scaleFactor","document","old","target","parentNode","updateMatrixWorld","vec","cssText","appendChild","removeChild","unmountComponentAtNode","styles","position","transform","abs","display","zIndex","HTML","console","warn","Shadow","fog","colorStop","color","canvas","context","getContext","gradient","createRadialGradient","addColorStop","getStyle","fillStyle","fillRect","stop","transparent","Stats","showPanel","parent","stats","node","body","dom","classList","begin","end","WobbleMaterialImpl","parameters","call","setValues","_time","_factor","onBeforeCompile","shader","uniforms","time","factor","vertexShader","replace","Object","defineProperty","get","set","val","prototype","create","constructor","isMeshStandardMaterial","MeshWobbleMaterial","speed","clock","getElapsedTime","SkyImpl","sunPosition","setScalar","Line","points","vertexColors","rest","lineRef","geomRef","resolution","setPositions","flat","setColors","computeLineDistances","Boolean","StarfieldMaterial","fade","fragmentShader","genStar","r","setFromSpherical","acos","random","Stars","depth","count","saturation","positions","colors","sizes","Array","from","increment","i","toArray","setHSL","g","b","Float32Array","attachObject","blending","draco","loader","dracoLoader","setDecoderPath","setDRACOLoader","pcss","frustrum","softShadows","shadowmap_pars_fragment","_inverseMatrix","_ray","_sphere","_vA","meshBounds","raycaster","intersects","geometry","boundingSphere","computeBoundingSphere","copy","applyMatrix4","ray","intersectsSphere","getInverse","boundingBox","intersectBox","origin","point","clone","useCamera","mouse","raycast","setFromCamera","rc","bind","useHelper","object3D","proto","helper","useAspect","viewport","v","adaptedHeight","adaptedWidth","El","Box","Circle","Cone","Cylinder","Plane","Tube","Torus","TorusKnot","Tetrahedron","Ring","Polyhedron","Icosahedron","Octahedron","Dodecahedron","Extrude","Lathe","Parametric"],"mappings":"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","sourcesContent":["import _extends from '@babel/runtime/helpers/esm/extends';\nimport React, { forwardRef, useRef, useEffect, useLayoutEffect, useState, useMemo, Children, createElement } from 'react';\nimport { extend, useThree, useFrame, useUpdate, useLoader, addEffect, addAfterEffect, applyProps } from 'react-three-fiber';\nimport { OrbitControls as OrbitControls$1, MapControls as MapControls$1 } from 'three/examples/jsm/controls/OrbitControls';\nimport mergeRefs from 'react-merge-refs';\nimport { TrackballControls as TrackballControls$1 } from 'three/examples/jsm/controls/TrackballControls';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport { TransformControls as TransformControls$1 } from 'three/examples/jsm/controls/TransformControls';\nimport pick from 'lodash.pick';\nimport omit from 'lodash.omit';\nimport { AudioListener, AudioLoader, HalfFloatType, Vector3, PerspectiveCamera as PerspectiveCamera$1, OrthographicCamera as OrthographicCamera$1, Color, MeshStandardMaterial, Vector2, Spherical, AdditiveBlending, ShaderMaterial, ShaderChunk, Matrix4, Ray, Sphere as Sphere$1, Raycaster, Camera } from 'three';\nimport { SMAAImageLoader, EffectComposer, RenderPass, SMAAEffect, NormalPass, SSAOEffect, BlendFunction, BloomEffect, KernelSize, EffectPass } from 'postprocessing';\nimport { Text as Text$1 } from 'troika-three-text';\nimport ReactDOM from 'react-dom';\nimport StatsImpl from 'stats.js';\nimport { Sky as Sky$1 } from 'three/examples/jsm/objects/Sky';\nimport { LineGeometry } from 'three/examples/jsm/lines/LineGeometry';\nimport { LineMaterial } from 'three/examples/jsm/lines/LineMaterial';\nimport { Line2 } from 'three/examples/jsm/lines/Line2';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader';\n\nextend({\n  OrbitControlsImpl: OrbitControls$1\n});\nconst OrbitControls = /*#__PURE__*/forwardRef((props = {\n  enableDamping: true\n}, ref) => {\n  const controls = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useFrame(() => {\n    var _controls$current;\n\n    return (_controls$current = controls.current) == null ? void 0 : _controls$current.update();\n  });\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(\"orbitControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement],\n    enableDamping: true\n  }, props));\n});\n\nextend({\n  MapControlsImpl: MapControls$1\n});\nconst MapControls = /*#__PURE__*/forwardRef((props = {\n  enableDamping: true\n}, ref) => {\n  const controls = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useFrame(() => {\n    var _controls$current;\n\n    return (_controls$current = controls.current) == null ? void 0 : _controls$current.update();\n  });\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(\"mapControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement],\n    enableDamping: true\n  }, props));\n});\n\nextend({\n  TrackballControlsImpl: TrackballControls$1\n});\nconst TrackballControls = /*#__PURE__*/forwardRef((props, ref) => {\n  const controls = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useFrame(() => {\n    var _controls$current;\n\n    return (_controls$current = controls.current) == null ? void 0 : _controls$current.update();\n  });\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(\"trackballControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement]\n  }, props));\n});\n\nextend({\n  TransformControlsImpl: TransformControls$1\n});\nconst TransformControls = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\"]);\n\n  const transformOnlyPropNames = ['enabled', 'axis', 'mode', 'translationSnap', 'rotationSnap', 'scaleSnap', 'space', 'size', 'dragging', 'showX', 'showY', 'showZ'];\n  const transformProps = pick(props, transformOnlyPropNames);\n  const objectProps = omit(props, transformOnlyPropNames);\n  const controls = useRef();\n  const group = useRef();\n  const {\n    camera,\n    gl,\n    invalidate\n  } = useThree();\n  useLayoutEffect(() => {\n    var _controls$current;\n\n    return void ((_controls$current = controls.current) == null ? void 0 : _controls$current.attach(group.current));\n  }, [children]);\n  useEffect(() => {\n    var _controls$current2;\n\n    (_controls$current2 = controls.current) == null ? void 0 : _controls$current2.addEventListener('change', invalidate);\n    return () => {\n      var _controls$current3;\n\n      return (_controls$current3 = controls.current) == null ? void 0 : _controls$current3.removeEventListener('change', invalidate);\n    };\n  }, [controls.current]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"transformControlsImpl\", _extends({\n    ref: mergeRefs([controls, ref]),\n    args: [camera, gl.domElement]\n  }, transformProps)), /*#__PURE__*/React.createElement(\"group\", _extends({\n    ref: group\n  }, objectProps), children));\n});\n\nconst Detailed = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    distances\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"distances\"]);\n\n  const lod = useUpdate(lod => {\n    lod.levels.length = 0;\n    lod.children.forEach((object, index) => lod.levels.push({\n      object,\n      distance: distances[index]\n    }));\n  }, []);\n  useFrame(state => {\n    var _lod$current;\n\n    return (_lod$current = lod.current) == null ? void 0 : _lod$current.update(state.camera);\n  });\n  return /*#__PURE__*/React.createElement(\"lOD\", _extends({\n    ref: mergeRefs([lod, ref])\n  }, props), children);\n});\n\nconst PositionalAudio = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    url,\n    distance = 1,\n    loop = true\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"url\", \"distance\", \"loop\"]);\n\n  const sound = useRef();\n  const {\n    camera\n  } = useThree();\n  const [listener] = useState(() => new AudioListener());\n  const buffer = useLoader(AudioLoader, url);\n  useEffect(() => {\n    var _sound$current, _sound$current2, _sound$current3, _sound$current4;\n\n    (_sound$current = sound.current) == null ? void 0 : _sound$current.setBuffer(buffer);\n    (_sound$current2 = sound.current) == null ? void 0 : _sound$current2.setRefDistance(distance);\n    (_sound$current3 = sound.current) == null ? void 0 : _sound$current3.setLoop(loop);\n    (_sound$current4 = sound.current) == null ? void 0 : _sound$current4.play();\n    camera.add(listener);\n    return () => void camera.remove(listener);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"positionalAudio\", _extends({\n    ref: mergeRefs([sound, ref]),\n    args: [listener]\n  }, props));\n});\n\nconst PerspectiveCamera = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    makeDefault = false\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"makeDefault\"]);\n\n  const {\n    setDefaultCamera,\n    camera,\n    size\n  } = useThree();\n  const cameraRef = useUpdate(cam => {\n    cam.aspect = size.width / size.height;\n    cam.updateProjectionMatrix();\n  }, [size, props]);\n  useLayoutEffect(() => {\n    if (makeDefault && cameraRef.current) {\n      const oldCam = camera;\n      setDefaultCamera(cameraRef.current);\n      return () => setDefaultCamera(oldCam);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(\"perspectiveCamera\", _extends({\n    ref: mergeRefs([cameraRef, ref])\n  }, props), children);\n});\n\nconst OrthographicCamera = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    children,\n    makeDefault = false\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"makeDefault\"]);\n\n  const {\n    setDefaultCamera,\n    camera,\n    size\n  } = useThree();\n  const cameraRef = useUpdate(cam => cam.updateProjectionMatrix(), [size, props]);\n  useLayoutEffect(() => {\n    if (makeDefault && cameraRef.current) {\n      const oldCam = camera;\n      setDefaultCamera(cameraRef.current);\n      return () => setDefaultCamera(oldCam);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(\"orthographicCamera\", _extends({\n    left: size.width / -2,\n    right: size.width / 2,\n    top: size.height / 2,\n    bottom: size.height / -2,\n    ref: mergeRefs([cameraRef, ref])\n  }, props), children);\n});\n\nfunction StandardEffects({\n  smaa = true,\n  ao = true,\n  bloom = true,\n  edgeDetection = 0.1,\n  bloomOpacity = 1,\n  effects\n}) {\n  const {\n    gl,\n    scene,\n    camera,\n    size\n  } = useThree();\n  const smaaProps = useLoader(SMAAImageLoader, '');\n  const composer = useMemo(() => {\n    const composer = new EffectComposer(gl, {\n      frameBufferType: HalfFloatType\n    });\n    composer.addPass(new RenderPass(scene, camera));\n    const smaaEffect = new SMAAEffect(...smaaProps);\n    smaaEffect.colorEdgesMaterial.setEdgeDetectionThreshold(edgeDetection);\n    const normalPass = new NormalPass(scene, camera);\n    const ssaoEffect = new SSAOEffect(camera, normalPass.renderTarget.texture, _extends({\n      blendFunction: BlendFunction.MULTIPLY,\n      samples: 21,\n      // May get away with less samples\n      rings: 4,\n      // Just make sure this isn't a multiple of samples\n      distanceThreshold: 1.0,\n      distanceFalloff: 0.0,\n      rangeThreshold: 0.015,\n      // Controls sensitivity based on camera view distance **\n      rangeFalloff: 0.002,\n      luminanceInfluence: 0.9,\n      radius: 20,\n      // Spread range\n      scale: 1.0,\n      // Controls intensity **\n      bias: 0.05\n    }, ao));\n    const bloomEffect = new BloomEffect(_extends({\n      opacity: 1,\n      blendFunction: BlendFunction.SCREEN,\n      kernelSize: KernelSize.VERY_LARGE,\n      luminanceThreshold: 0.9,\n      luminanceSmoothing: 0.07,\n      height: 600\n    }, bloom));\n    bloomEffect.blendMode.opacity.value = bloomOpacity;\n    let effectsArray = [];\n    if (effects) effectsArray = effects([smaaEffect, ssaoEffect, bloomEffect]);else {\n      if (smaa) effectsArray.push(smaaEffect);\n      if (ao) effectsArray.push(ssaoEffect);\n      if (bloom) effectsArray.push(bloomEffect);\n    }\n    const effectPass = new EffectPass(camera, ...effectsArray);\n    effectPass.renderToScreen = true;\n    composer.addPass(normalPass);\n    composer.addPass(effectPass);\n    return composer;\n  }, [camera, gl, scene, smaa, ao, bloom, edgeDetection, bloomOpacity]);\n  useEffect(() => void composer.setSize(size.width, size.height), [composer, size]);\n  return useFrame((_, delta) => composer.render(delta), 1);\n}\n\nextend({\n  TextMeshImpl: Text$1\n});\nconst Text = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    anchorX = 'center',\n    anchorY = 'middle',\n    children\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"anchorX\", \"anchorY\", \"children\"]);\n\n  const textRef = useRef();\n  const [baseMtl, setBaseMtl] = useState();\n  const [nodes, text] = useMemo(() => {\n    let n = [];\n    let t = '';\n    Children.forEach(children, child => {\n      if (typeof child === 'string') t += child;else if (child && typeof child === 'object' && child.props.attach === 'material') {\n        // Instantiate the base material and grab a reference to it, but don't assign any\n        // props, and assign it as the `material`, which Troika will replace behind the scenes.\n        n.push( /*#__PURE__*/createElement(child.type, {\n          ref: setBaseMtl,\n          attach: 'material'\n        })); // Once the base material has been assigned, grab the resulting upgraded material,\n        // and apply the original material props to that.\n\n        if (baseMtl) {\n          n.push( /*#__PURE__*/React.createElement(\"primitive\", _extends({\n            object: textRef.current.material\n          }, child.props, {\n            attach: null\n          })));\n        }\n      } else n.push(child);\n    });\n    return [n, t];\n  }, [children, baseMtl]);\n  useLayoutEffect(() => void textRef.current.sync());\n  return /*#__PURE__*/React.createElement(\"textMeshImpl\", _extends({\n    ref: mergeRefs([textRef, ref]),\n    text: text,\n    anchorX: anchorX,\n    anchorY: anchorY\n  }, props), nodes);\n});\n\nconst v1 = new Vector3();\nconst v2 = new Vector3();\nconst v3 = new Vector3();\n\nfunction calculatePosition(el, camera, size) {\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n  objectPos.project(camera);\n  const widthHalf = size.width / 2;\n  const heightHalf = size.height / 2;\n  return [objectPos.x * widthHalf + widthHalf, -(objectPos.y * heightHalf) + heightHalf];\n}\n\nfunction isObjectBehindCamera(el, camera) {\n  const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n  const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n  const deltaCamObj = objectPos.sub(cameraPos);\n  const camDir = camera.getWorldDirection(v3);\n  return deltaCamObj.angleTo(camDir) > Math.PI / 2;\n}\n\nfunction objectScale(el, camera) {\n  if (camera instanceof PerspectiveCamera$1) {\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n    const vFOV = camera.fov * Math.PI / 180;\n    const dist = objectPos.distanceTo(cameraPos);\n    return 1 / (2 * Math.tan(vFOV / 2) * dist);\n  }\n\n  if (camera instanceof OrthographicCamera$1) return camera.zoom;\n  return 1;\n}\n\nfunction objectZIndex(el, camera, zIndexRange) {\n  if (camera instanceof PerspectiveCamera$1 || camera instanceof OrthographicCamera$1) {\n    const objectPos = v1.setFromMatrixPosition(el.matrixWorld);\n    const cameraPos = v2.setFromMatrixPosition(camera.matrixWorld);\n    const dist = objectPos.distanceTo(cameraPos);\n    const A = (zIndexRange[1] - zIndexRange[0]) / (camera.far - camera.near);\n    const B = zIndexRange[1] - A * camera.far;\n    return Math.round(A * dist + B);\n  }\n\n  return undefined;\n}\n\nconst Html = /*#__PURE__*/React.forwardRef((_ref, ref) => {\n  var _portal$current;\n\n  let {\n    children,\n    eps = 0.001,\n    style,\n    className,\n    prepend,\n    center,\n    fullscreen,\n    portal,\n    scaleFactor,\n    zIndexRange = [16777271, 0]\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"children\", \"eps\", \"style\", \"className\", \"prepend\", \"center\", \"fullscreen\", \"portal\", \"scaleFactor\", \"zIndexRange\"]);\n\n  const {\n    gl,\n    scene,\n    camera,\n    size\n  } = useThree();\n  const [el] = useState(() => document.createElement('div'));\n  const group = useRef(null);\n  const old = useRef([0, 0]);\n  const target = (_portal$current = portal == null ? void 0 : portal.current) != null ? _portal$current : gl.domElement.parentNode;\n  useEffect(() => {\n    if (group.current) {\n      scene.updateMatrixWorld();\n      const vec = calculatePosition(group.current, camera, size);\n      el.style.cssText = \"position:absolute;top:0;left:0;transform:translate3d(\" + vec[0] + \"px,\" + vec[1] + \"px,0);transform-origin:0 0;\";\n\n      if (target) {\n        if (prepend) target.prepend(el);else target.appendChild(el);\n      }\n\n      return () => {\n        if (target) target.removeChild(el);\n        ReactDOM.unmountComponentAtNode(el);\n      };\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [target]);\n  const styles = useMemo(() => _extends({\n    position: 'absolute',\n    transform: center ? 'translate3d(-50%,-50%,0)' : 'none'\n  }, fullscreen && {\n    top: -size.height / 2,\n    left: -size.width / 2,\n    width: size.width,\n    height: size.height\n  }, style), [style, center, fullscreen, size]);\n  useEffect(() => void ReactDOM.render( /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    style: styles,\n    className: className,\n    children: children\n  }), el));\n  useFrame(() => {\n    if (group.current) {\n      const vec = calculatePosition(group.current, camera, size);\n\n      if (Math.abs(old.current[0] - vec[0]) > eps || Math.abs(old.current[1] - vec[1]) > eps) {\n        el.style.display = !isObjectBehindCamera(group.current, camera) ? 'block' : 'none';\n        const scale = scaleFactor === undefined ? 1 : objectScale(group.current, camera) * scaleFactor;\n        el.style.transform = \"translate3d(\" + vec[0] + \"px,\" + vec[1] + \"px,0) scale(\" + scale + \")\";\n        el.style.zIndex = \"\" + objectZIndex(group.current, camera, zIndexRange);\n      }\n\n      old.current = vec;\n    }\n  });\n  return /*#__PURE__*/React.createElement(\"group\", _extends({}, props, {\n    ref: group\n  }));\n});\nconst HTML = /*#__PURE__*/React.forwardRef((props, ref) => {\n  useEffect(() => void console.warn('The <HTML> component was renamed to <Html>'), []);\n  return /*#__PURE__*/React.createElement(Html, _extends({}, props, {\n    ref: ref\n  }));\n});\n\nconst Shadow = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    fog = false,\n    colorStop = 0.0,\n    color = 'black',\n    opacity = 0.5\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"fog\", \"colorStop\", \"color\", \"opacity\"]);\n\n  const canvas = useMemo(() => {\n    let canvas = document.createElement('canvas');\n    canvas.width = 128;\n    canvas.height = 128;\n    let context = canvas.getContext('2d');\n    let gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width / 2);\n    gradient.addColorStop(colorStop, new Color(color).getStyle());\n    gradient.addColorStop(1, 'rgba(0,0,0,0)');\n    context.fillStyle = gradient;\n    context.fillRect(0, 0, canvas.width, canvas.height);\n    return canvas;\n  }, [color, stop]);\n  return /*#__PURE__*/React.createElement(\"mesh\", _extends({\n    ref: ref\n  }, props), /*#__PURE__*/React.createElement(\"planeBufferGeometry\", {\n    attach: \"geometry\",\n    args: [1, 1]\n  }), /*#__PURE__*/React.createElement(\"meshBasicMaterial\", {\n    attach: \"material\",\n    transparent: true,\n    opacity: opacity,\n    fog: fog\n  }, /*#__PURE__*/React.createElement(\"canvasTexture\", {\n    attach: \"map\",\n    args: [canvas]\n  })));\n});\n\nfunction Stats({\n  showPanel = 0,\n  className,\n  parent\n}) {\n  const [stats] = useState(() => new StatsImpl());\n  useEffect(() => {\n    const node = parent && parent.current || document.body;\n    stats.showPanel(showPanel);\n    node == null ? void 0 : node.appendChild(stats.dom);\n    if (className) stats.dom.classList.add(className);\n    const begin = addEffect(() => stats.begin());\n    const end = addAfterEffect(() => stats.end());\n    return () => {\n      node == null ? void 0 : node.removeChild(stats.dom);\n      begin();\n      end();\n    };\n  }, [parent]);\n  return null;\n}\n\nfunction WobbleMaterialImpl(parameters) {\n  MeshStandardMaterial.call(this);\n  this.setValues(parameters);\n  this._time = {\n    value: 0\n  };\n  this._factor = {\n    value: 1\n  };\n\n  this.onBeforeCompile = shader => {\n    shader.uniforms.time = this._time;\n    shader.uniforms.factor = this._factor;\n    shader.vertexShader = 'uniform float time; uniform float factor;\\n' + shader.vertexShader;\n    shader.vertexShader = shader.vertexShader.replace('#include <begin_vertex>', \"float theta = sin( time + position.y ) / 2.0 * factor;\\n        float c = cos( theta );\\n        float s = sin( theta );\\n        mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\\n        vec3 transformed = vec3( position ) * m;\\n        vNormal = vNormal * m;\");\n  };\n\n  Object.defineProperty(this, 'time', {\n    get: () => this._time,\n    set: val => this._time.value = val\n  });\n  Object.defineProperty(this, 'factor', {\n    get: () => this._factor,\n    set: val => this._factor.value = val\n  });\n}\n\nWobbleMaterialImpl.prototype = Object.create(MeshStandardMaterial.prototype);\nWobbleMaterialImpl.prototype.constructor = MeshStandardMaterial;\nWobbleMaterialImpl.prototype.isMeshStandardMaterial = true;\nextend({\n  WobbleMaterialImpl\n});\nconst MeshWobbleMaterial = /*#__PURE__*/React.forwardRef((_ref, ref) => {\n  let {\n    speed = 1\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"speed\"]);\n\n  const material = useRef();\n  useFrame(state => material.current && (material.current.time = state.clock.getElapsedTime() * speed));\n  return /*#__PURE__*/React.createElement(\"wobbleMaterialImpl\", _extends({\n    ref: mergeRefs([ref, material]),\n    attach: \"material\"\n  }, props));\n});\n\nextend({\n  SkyImpl: Sky$1\n});\nconst Sky = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    distance = 450000,\n    sunPosition = [0, 1, 0]\n  } = _ref,\n      props = _objectWithoutPropertiesLoose(_ref, [\"distance\", \"sunPosition\"]);\n\n  const scale = useMemo(() => new Vector3().setScalar(distance), [distance]);\n  return /*#__PURE__*/React.createElement(\"skyImpl\", _extends({\n    ref: ref,\n    \"material-uniforms-sunPosition-value\": sunPosition,\n    scale: scale\n  }, props));\n});\n\nextend({\n  Line2,\n  LineGeometry,\n  LineMaterial\n});\nconst Line = /*#__PURE__*/React.forwardRef(function Line(_ref, ref) {\n  let {\n    points,\n    color = 'black',\n    vertexColors\n  } = _ref,\n      rest = _objectWithoutPropertiesLoose(_ref, [\"points\", \"color\", \"vertexColors\"]);\n\n  const lineRef = useRef();\n  const geomRef = useRef();\n  const resolution = useMemo(() => new Vector2(512, 512), []);\n  useEffect(() => {\n    if (!geomRef.current || !lineRef.current) return;\n    geomRef.current.setPositions(points.flat());\n    if (vertexColors) geomRef.current.setColors(vertexColors.flat());\n    lineRef.current.computeLineDistances();\n  }, [points, vertexColors]);\n  return /*#__PURE__*/React.createElement(\"line2\", _extends({\n    ref: mergeRefs([lineRef, ref])\n  }, rest), /*#__PURE__*/React.createElement(\"lineGeometry\", {\n    attach: \"geometry\",\n    ref: geomRef\n  }), /*#__PURE__*/React.createElement(\"lineMaterial\", _extends({\n    attach: \"material\",\n    color: color,\n    vertexColors: Boolean(vertexColors),\n    resolution: resolution\n  }, rest)));\n});\n\nclass StarfieldMaterial extends ShaderMaterial {\n  constructor() {\n    super({\n      uniforms: {\n        time: {\n          value: 0.0\n        },\n        fade: {\n          value: 1.0\n        }\n      },\n      vertexShader: \"uniform float time;\\n      attribute float size;\\n      varying vec3 vColor;\\n      void main() {\\n        vColor = color;\\n        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);\\n        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(mvPosition.x + 2.0 * time + 100.0));\\n        gl_Position = projectionMatrix * mvPosition;\\n      }\",\n      fragmentShader: \"uniform sampler2D pointTexture;\\n      uniform float fade;\\n      varying vec3 vColor;\\n      void main() {\\n        float opacity = 1.0;\\n        if (fade == 1.0) {\\n          float d = distance(gl_PointCoord, vec2(0.5, 0.5));\\n          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));\\n        }\\n        gl_FragColor = vec4(vColor, opacity);\\n      }\"\n    });\n  }\n\n}\n\nextend({\n  StarfieldMaterial\n});\n\nconst genStar = r => {\n  return new Vector3().setFromSpherical(new Spherical(r, Math.acos(1 - Math.random() * 2), Math.random() * 2 * Math.PI));\n};\n\nconst Stars = /*#__PURE__*/forwardRef(({\n  radius = 100,\n  depth = 50,\n  count = 5000,\n  saturation = 0,\n  factor = 4,\n  fade = false\n}, ref) => {\n  const material = useRef();\n  const [position, color, size] = useMemo(() => {\n    const positions = [];\n    const colors = [];\n    const sizes = Array.from({\n      length: count\n    }, () => (0.5 + 0.5 * Math.random()) * factor);\n    const color = new Color();\n    let r = radius + depth;\n    const increment = depth / count;\n\n    for (var i = 0; i < count; i++) {\n      r -= increment * Math.random();\n      positions.push(...genStar(r).toArray());\n      color.setHSL(i / count, saturation, 0.9);\n      colors.push(color.r, color.g, color.b);\n    }\n\n    return [new Float32Array(positions), new Float32Array(colors), new Float32Array(sizes)];\n  }, []);\n  useFrame(state => material.current && (material.current.uniforms.time.value = state.clock.getElapsedTime()));\n  return /*#__PURE__*/React.createElement(\"points\", {\n    ref: ref\n  }, /*#__PURE__*/React.createElement(\"bufferGeometry\", {\n    attach: \"geometry\"\n  }, /*#__PURE__*/React.createElement(\"bufferAttribute\", {\n    attachObject: ['attributes', 'position'],\n    args: [position, 3]\n  }), /*#__PURE__*/React.createElement(\"bufferAttribute\", {\n    attachObject: ['attributes', 'color'],\n    args: [color, 3]\n  }), /*#__PURE__*/React.createElement(\"bufferAttribute\", {\n    attachObject: ['attributes', 'size'],\n    args: [size, 1]\n  })), /*#__PURE__*/React.createElement(\"starfieldMaterial\", {\n    ref: material,\n    attach: \"material\",\n    blending: AdditiveBlending,\n    \"uniforms-fade-value\": fade,\n    transparent: true,\n    vertexColors: true\n  }));\n});\n\nfunction draco(url = '/draco-gltf/') {\n  return loader => {\n    const dracoLoader = new DRACOLoader();\n    dracoLoader.setDecoderPath(url);\n    loader.setDRACOLoader(dracoLoader);\n  };\n}\n\nconst pcss = ({\n  frustrum = 3.75,\n  size = 0.005,\n  near = 9.5,\n  samples = 17,\n  rings = 11\n} = {}) => \"#define LIGHT_WORLD_SIZE \" + size + \"\\n#define LIGHT_FRUSTUM_WIDTH \" + frustrum + \"\\n#define LIGHT_SIZE_UV (LIGHT_WORLD_SIZE / LIGHT_FRUSTUM_WIDTH)\\n#define NEAR_PLANE \" + near + \"\\n\\n#define NUM_SAMPLES \" + samples + \"\\n#define NUM_RINGS \" + rings + \"\\n#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES\\n#define PCF_NUM_SAMPLES NUM_SAMPLES\\n\\nvec2 poissonDisk[NUM_SAMPLES];\\n\\nvoid initPoissonSamples(const in vec2 randomSeed) {\\n\\tfloat ANGLE_STEP = PI2 * float(NUM_RINGS) / float(NUM_SAMPLES);\\n\\tfloat INV_NUM_SAMPLES = 1.0 / float(NUM_SAMPLES);\\n\\tfloat angle = rand(randomSeed) * PI2;\\n\\tfloat radius = INV_NUM_SAMPLES;\\n\\tfloat radiusStep = radius;\\n\\tfor (int i = 0; i < NUM_SAMPLES; i++) {\\n\\t\\tpoissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\\n\\t\\tradius += radiusStep;\\n\\t\\tangle += ANGLE_STEP;\\n\\t}\\n}\\n\\nfloat penumbraSize(const in float zReceiver, const in float zBlocker) { // Parallel plane estimation\\n\\treturn (zReceiver - zBlocker) / zBlocker;\\n}\\n\\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver) {\\n\\tfloat searchRadius = LIGHT_SIZE_UV * (zReceiver - NEAR_PLANE) / zReceiver;\\n\\tfloat blockerDepthSum = 0.0;\\n\\tint numBlockers = 0;\\n\\tfor (int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++) {\\n\\t\\tfloat shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\\n\\t\\tif (shadowMapDepth < zReceiver) {\\n\\t\\t\\tblockerDepthSum += shadowMapDepth;\\n\\t\\t\\tnumBlockers++;\\n\\t\\t}\\n\\t}\\n\\tif (numBlockers == 0) return -1.0;\\n\\treturn blockerDepthSum / float(numBlockers);\\n}\\n\\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\\n\\tfloat sum = 0.0;\\n\\tfor (int i = 0; i < PCF_NUM_SAMPLES; i++) {\\n\\t\\tfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[ i ] * filterRadius));\\n\\t\\tif (zReceiver <= depth) sum += 1.0;\\n\\t}\\n\\tfor (int i = 0; i < PCF_NUM_SAMPLES; i++) {\\n\\t\\tfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[ i ].yx * filterRadius));\\n\\t\\tif (zReceiver <= depth) sum += 1.0;\\n\\t}\\n\\treturn sum / (2.0 * float(PCF_NUM_SAMPLES));\\n}\\n\\nfloat PCSS(sampler2D shadowMap, vec4 coords) {\\n\\tvec2 uv = coords.xy;\\n\\tfloat zReceiver = coords.z; // Assumed to be eye-space z in this code\\n\\tinitPoissonSamples(uv);\\n\\tfloat avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\\n\\tif (avgBlockerDepth == -1.0) return 1.0;\\n\\tfloat penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\\n\\tfloat filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;\\n\\treturn PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\\n}\";\n\nconst softShadows = props => {\n  let shader = ShaderChunk.shadowmap_pars_fragment;\n  shader = shader.replace('#ifdef USE_SHADOWMAP', '#ifdef USE_SHADOWMAP\\n' + pcss(_extends({}, props)));\n  shader = shader.replace('#if defined( SHADOWMAP_TYPE_PCF )', '\\nreturn PCSS(shadowMap, shadowCoord);\\n#if defined( SHADOWMAP_TYPE_PCF )');\n  ShaderChunk.shadowmap_pars_fragment = shader;\n};\n\nlet _inverseMatrix = new Matrix4();\n\nlet _ray = new Ray();\n\nlet _sphere = new Sphere$1();\n\nlet _vA = new Vector3();\n\nfunction meshBounds(raycaster, intersects) {\n  let geometry = this.geometry;\n  let material = this.material;\n  let matrixWorld = this.matrixWorld;\n  if (material === undefined) return; // Checking boundingSphere distance to ray\n\n  if (geometry.boundingSphere === null) geometry.computeBoundingSphere();\n\n  _sphere.copy(geometry.boundingSphere);\n\n  _sphere.applyMatrix4(matrixWorld);\n\n  if (raycaster.ray.intersectsSphere(_sphere) === false) return;\n\n  _inverseMatrix.getInverse(matrixWorld);\n\n  _ray.copy(raycaster.ray).applyMatrix4(_inverseMatrix); // Check boundingBox before continuing\n\n\n  if (geometry.boundingBox !== null && _ray.intersectBox(geometry.boundingBox, _vA) === null) return;\n  intersects.push({\n    distance: _vA.distanceTo(raycaster.ray.origin),\n    point: _vA.clone(),\n    object: this\n  });\n}\n\nfunction useCamera(camera, props) {\n  const {\n    mouse\n  } = useThree();\n  const [raycast] = useState(() => {\n    let raycaster = new Raycaster();\n    if (props) applyProps(raycaster, props, {});\n    return function (_, intersects) {\n      raycaster.setFromCamera(mouse, camera instanceof Camera ? camera : camera.current);\n      const rc = this.constructor.prototype.raycast.bind(this);\n      if (rc) rc(raycaster, intersects);\n    };\n  });\n  return raycast;\n}\n\nfunction useHelper(object3D, proto, ...args) {\n  const helper = React.useRef();\n  const {\n    scene\n  } = useThree();\n  useEffect(() => {\n    if (proto && object3D.current) {\n      helper.current = new proto(object3D.current, ...args);\n\n      if (helper.current) {\n        scene.add(helper.current);\n      }\n    }\n\n    return () => {\n      if (helper.current) {\n        scene.remove(helper.current);\n      }\n    };\n  }, [scene, proto, object3D, args]);\n  useFrame(() => {\n    if (helper.current) {\n      helper.current.update();\n    }\n  });\n  return helper;\n}\n\nfunction useAspect(type, width, height, factor = 1) {\n  const {\n    viewport: v,\n    aspect\n  } = useThree();\n  const adaptedHeight = height * (aspect > width / height ? v.width / width : v.height / height);\n  const adaptedWidth = width * (aspect > width / height ? v.width / width : v.height / height);\n  return [adaptedWidth * factor, adaptedHeight * factor, 1];\n}\n\nfunction create(type) {\n  const El = type + 'BufferGeometry';\n  return /*#__PURE__*/forwardRef((_ref, ref) => {\n    let {\n      args,\n      children\n    } = _ref,\n        props = _objectWithoutPropertiesLoose(_ref, [\"args\", \"children\"]);\n\n    return /*#__PURE__*/React.createElement(\"mesh\", _extends({\n      ref: ref\n    }, props), /*#__PURE__*/React.createElement(El, {\n      attach: \"geometry\",\n      args: args\n    }), children);\n  });\n}\n\nconst Box = create('box');\nconst Circle = create('circle');\nconst Cone = create('cone');\nconst Cylinder = create('cylinder');\nconst Sphere = create('sphere');\nconst Plane = create('plane');\nconst Tube = create('tube');\nconst Torus = create('torus');\nconst TorusKnot = create('torusKnot');\nconst Tetrahedron = create('tetrahedron');\nconst Ring = create('ring');\nconst Polyhedron = create('polyhedron');\nconst Icosahedron = create('icosahedron');\nconst Octahedron = create('octahedron');\nconst Dodecahedron = create('dodecahedron');\nconst Extrude = create('extrude');\nconst Lathe = create('lathe');\nconst Parametric = create('parametric');\n\nexport { Box, Circle, Cone, Cylinder, Detailed, Dodecahedron, Extrude, HTML, Html, Icosahedron, Lathe, Line, MapControls, MeshWobbleMaterial, Octahedron, OrbitControls, OrthographicCamera, Parametric, PerspectiveCamera, Plane, Polyhedron, PositionalAudio, Ring, Shadow, Sky, Sphere, StandardEffects, Stars, Stats, Tetrahedron, Text, Torus, TorusKnot, TrackballControls, TransformControls, Tube, draco, meshBounds, softShadows, useAspect, useCamera, useHelper };\n"]},"metadata":{},"sourceType":"module"}